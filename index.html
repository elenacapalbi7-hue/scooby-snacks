<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Scooby: Torneo Maestro v2</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; touch-action: none; -webkit-user-select: none; }
        #game-container { position: relative; width: 100vw; height: 100vh; display: flex; justify-content: center; align-items: center; }
        canvas { background: #111; max-width: 100%; max-height: 100%; border: 3px solid #ccff00; }
        #ui { position: absolute; top: 10px; width: 92%; display: flex; justify-content: space-between; color: #ccff00; font-family: sans-serif; font-weight: bold; z-index: 100; pointer-events: none; text-shadow: 2px 2px #000; }
        .menu { position: absolute; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 200; color: white; font-family: sans-serif; text-align: center; }
        .btn-main { padding: 18px 50px; font-size: 22px; background: #ccff00; border: none; border-radius: 50px; font-weight: bold; cursor: pointer; color: black; box-shadow: 0 6px 0 #88aa00; }
        .btn-main:active { transform: translateY(4px); box-shadow: none; }
    </style>
</head>
<body>

    <div id="game-container">
        <div id="ui">
            <div>DESTREZA: <span id="modeName">ESPERANDO</span></div>
            <div>üç™: <span id="sc">0</span></div>
            <div>TOP: <span id="topSc">0</span></div>
        </div>

        <div id="mainMenu" class="menu">
            <h1 style="color:#ccff00; font-size: 35px;">SCOOBY: TORNEO NIVEL 16</h1>
            <p>¬°Llega a las 110 galletas para ver el Nivel 12!</p>
            <button class="btn-main" onpointerdown="startGame(event)">¬°JUGAR AHORA!</button>
        </div>

        <div id="deathMenu" class="menu" style="display:none;">
            <h1 style="color:red; font-size: 40px;">¬°GAME OVER!</h1>
            <h2 id="finalScore" style="font-size: 60px;">0</h2>
            <button class="btn-main" onpointerdown="startGame(event)">REINTENTAR</button>
        </div>

        <canvas id="c"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('c');
        const ctx = canvas.getContext('2d');
        canvas.width = 800; canvas.height = 450;

        const imgS = new Image(); imgS.src = '4d0e8e93e8663b020f6063451e53118a.png';
        const imgG = new Image(); imgG.src = 'eb4380a3cf64873dc0ebbad595d0886f.png';
        const imgB = new Image(); imgB.src = '1766045750713.png';
        const imgF = new Image(); imgF.src = '535eb96ca41945fbcd1774e60989d8e3.png';
        
        const sndJ = new Audio('audio saltoo.mp4');
        const sndE = new Audio('audio galletaa.mp4');
        const bgM = new Audio('DanLebowitzTiptoeOuttheBack.mp4'); bgM.loop = true;

        let score = 0, level = 1, speed = 7, active = false, frame = 0, gravity = 0.95;
        let scooby = { x: 80, y: 330, w: 75, h: 75, dy: 0, jumps: 0 };
        let obs = [], snacks = [], bgX = 0;

        document.getElementById('topSc').innerText = localStorage.getItem('scooby_top') || 0;

        function startGame(e) {
            if(e) e.stopPropagation();
            active = true; score = 0; level = 1; speed = 7; obs = []; snacks = []; frame = 0;
            scooby = { x: 80, y: 330, w: 75, h: 75, dy: 0, jumps: 0 }; gravity = 0.95;
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById('deathMenu').style.display = 'none';
            bgM.play().catch(()=>{});
            requestAnimationFrame(animate);
        }

        function handleInput() {
            if(!active) return;
            sndJ.currentTime = 0; sndJ.play().catch(()=>{});

            if (level === 2) scooby.dy = -7; 
            else if (level === 4) scooby.dy = -10; 
            else if (level === 5) { gravity = -gravity; scooby.dy = gravity * 12; } 
            else if (level === 6) scooby.dy = -12;
            else if (level === 9) { scooby.dy = -17; scooby.x += 20; if(scooby.x > 80) scooby.x = 80; }
            else if (level === 14) { scooby.dy = -14; } // Salto m√°s corto por ser gigante
            else { 
                if(scooby.jumps < 2) { scooby.dy = -17; scooby.jumps++; }
            }
        }

        window.onpointerdown = (e) => {
            if(active && e.target.tagName !== 'BUTTON') {
                e.preventDefault();
                handleInput();
            }
        };

        function animate() {
            if (!active) return;
            ctx.clearRect(0,0,800,450);
            
            bgX -= (speed/2); if(bgX <= -800) bgX = 0;
            ctx.drawImage(imgB, bgX, 0, 800, 450); ctx.drawImage(imgB, bgX+800, 0, 800, 450);

            scooby.dy += gravity;
            scooby.y += scooby.dy;

            // --- L√ìGICA DE NIVELES (1 AL 16) ---
            if (level <= 6) {
                // ... (Niveles anteriores se mantienen igual)
                if (level === 1) { document.getElementById('modeName').innerText = "1. CORREDOR"; if(scooby.y > 330) { scooby.y = 330; scooby.dy = 0; scooby.jumps = 0; } }
                else if (level === 2) { document.getElementById('modeName').innerText = "2. SUBMARINO"; gravity = 0.3; if(scooby.y > 350) scooby.y = 350; if(scooby.y < 0) scooby.y = 0; }
                else if (level === 3) { document.getElementById('modeName').innerText = "3. VAGONETA"; gravity = 1.3; speed = 11; if(scooby.y > 330) { scooby.y = 330; scooby.dy = 0; scooby.jumps = 0; } }
                else if (level === 4) { document.getElementById('modeName').innerText = "4. AVIONETA"; gravity = 0.6; if(frame % 70 === 0) obs.push({x: 800, y: 0, w: 60, h: 140}, {x: 800, y: 310, w: 60, h: 140}); if(scooby.y > 450 || scooby.y < -50) endGame(); }
                else if (level === 5) { document.getElementById('modeName').innerText = "5. GRAVEDAD X"; if(scooby.y > 330) { scooby.y = 330; scooby.dy = 0; } if(scooby.y < 0) { scooby.y = 0; scooby.dy = 0; } }
                else if (level === 6) { document.getElementById('modeName').innerText = "6. DIOS (MAX)"; gravity = 0.8; speed = 14; if(scooby.y > 450 || scooby.y < -50) endGame(); }
            } 
            else if (level === 7) { document.getElementById('modeName').innerText = "7. PESADO"; gravity = 2.3; if(scooby.y > 330) { scooby.y = 330; scooby.dy = 0; scooby.jumps = 0; } }
            else if (level === 8) { document.getElementById('modeName').innerText = "8. LUNAR"; gravity = 0.15; if(scooby.y > 330) { scooby.y = 330; scooby.dy = 0; scooby.jumps = 0; } if(scooby.y < 0) { scooby.y = 0; scooby.dy = 2; } }
            else if (level === 9) { document.getElementById('modeName').innerText = "9. VIENTO"; gravity = 0.95; scooby.x -= 0.8; if(scooby.x < -50) endGame(); if(scooby.y > 330) { scooby.y = 330; scooby.dy = 0; scooby.jumps = 0; } }
            else if (level === 10) { document.getElementById('modeName').innerText = "10. HIELO"; speed = 13 + Math.sin(frame * 0.05) * 4; if(scooby.y > 330) { scooby.y = 330; scooby.dy = 0; scooby.jumps = 0; } }
            else if (level === 11) { document.getElementById('modeName').innerText = "11. TERREMOTO"; let tremor = Math.sin(frame * 0.15) * 25; if(scooby.y > 330 + tremor) { scooby.y = 330 + tremor; scooby.dy = 0; scooby.jumps = 0; } }
            // --- NUEVOS NIVELES 12 AL 16 ---
            else if (level === 12) {
                document.getElementById('modeName').innerText = "12. FAST & FURIOUS";
                speed = 18; gravity = 1.1;
                if(scooby.y > 330) { scooby.y = 330; scooby.dy = 0; scooby.jumps = 0; }
            } else if (level === 13) {
                document.getElementById('modeName').innerText = "13. MINI-SCOOBY";
                scooby.w = 40; scooby.h = 40;
                if(scooby.y > 365) { scooby.y = 365; scooby.dy = 0; scooby.jumps = 0; }
            } else if (level === 14) {
                document.getElementById('modeName').innerText = "14. GRAN SCOOBY";
                scooby.w = 150; scooby.h = 150;
                if(scooby.y > 255) { scooby.y = 255; scooby.dy = 0; scooby.jumps = 0; }
            } else if (level === 15) {
                document.getElementById('modeName').innerText = "15. FANTASMA";
                scooby.w = 75; scooby.h = 75;
                ctx.globalAlpha = Math.sin(frame * 0.1) > 0 ? 1 : 0.1; // Parpadeo
                if(scooby.y > 330) { scooby.y = 330; scooby.dy = 0; scooby.jumps = 0; }
            } else if (level === 16) {
                document.getElementById('modeName').innerText = "16. NEBLINA";
                ctx.globalAlpha = 1;
                if(scooby.y > 330) { scooby.y = 330; scooby.dy = 0; scooby.jumps = 0; }
            } else {
                document.getElementById('modeName').innerText = "MODO EXPERTO";
                ctx.globalAlpha = 1; scooby.w = 75; scooby.h = 75;
                if(scooby.y > 330) { scooby.y = 330; scooby.dy = 0; scooby.jumps = 0; }
            }

            ctx.drawImage(imgS, scooby.x, scooby.y, scooby.w, scooby.h);
            ctx.globalAlpha = 1; // Reset alpha para otros elementos

            // Efecto Neblina para Nivel 16
            if(level === 16) {
                let grad = ctx.createLinearGradient(0,0,800,0);
                grad.addColorStop(0, 'rgba(0,0,0,0)');
                grad.addColorStop(0.5, 'rgba(0,0,0,0.8)');
                grad.addColorStop(1, 'rgba(0,0,0,0)');
                ctx.fillStyle = grad;
                ctx.fillRect(0,0,800,450);
            }

            // Obst√°culos
            let spawnRate = (level >= 12) ? 50 : 100;
            if(frame % spawnRate === 0 && level !== 4) {
                let obsY = 335;
                if(level === 5 && gravity < 0) obsY = 20;
                if(level === 11) obsY = 335 + Math.sin(frame * 0.15) * 25;
                if(level === 13) obsY = 345;
                obs.push({x: 800, y: obsY, w: 60, h: 60});
            }

            for(let i=obs.length-1; i>=0; i--) {
                obs[i].x -= (speed + 2);
                ctx.drawImage(imgF, obs[i].x, obs[i].y, obs[i].w, obs[i].h);
                // Colisi√≥n ajustada al tama√±o de Scooby
                if(scooby.x < obs[i].x+40 && scooby.x+scooby.w-15 > obs[i].x && scooby.y < obs[i].y+40 && scooby.y+scooby.h-15 > obs[i].y) endGame();
                if(obs[i].x < -100) obs.splice(i, 1);
            }

            // Galletas
            if(frame % 90 === 0) snacks.push({x: 800, y: 120 + Math.random()*180, w: 45, h: 45});
            for(let i=snacks.length-1; i>=0; i--){
                snacks[i].x -= speed;
                ctx.drawImage(imgG, snacks[i].x, snacks[i].y, snacks[i].w, snacks[i].h);
                if(scooby.x < snacks[i].x+40 && scooby.x+scooby.w > snacks[i].x && scooby.y < snacks[i].y+40 && scooby.y+scooby.h > snacks[i].y) {
                    snacks.splice(i,1); score++; sndE.play().catch(()=>{});
                    document.getElementById('sc').innerText = score;
                    if(score > 0 && score % 10 === 0) { 
                        level++; speed += 0.5; obs = [];
                        if(level !== 9) scooby.x = 80;
                    }
                }
                if(snacks[i] && snacks[i].x < -100) snacks.splice(i,1);
            }

            frame++;
            if(active) requestAnimationFrame(animate);
        }

        function endGame() {
            active = false; bgM.pause();
            let top = localStorage.getItem('scooby_top') || 0;
            if(score > top) { localStorage.setItem('scooby_top', score); top = score; }
            document.getElementById('topSc').innerText = top;
            document.getElementById('finalScore').innerText = score;
            document.getElementById('deathMenu').style.display = 'flex';
        }
    </script>
</body>
</html>
